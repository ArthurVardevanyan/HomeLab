version: "3.7"

services:
  pihole:
    container_name: pihole
    image: pihole/pihole
    hostname: pihole
    networks:
      dockerBridge:
        ipv4_address: 10.0.0.4
    ports:
      - "53:53/tcp"
      - "53:53/udp"
      - "67:67/udp"
      - "80:80/tcp"
    environment:
      TZ: "America/Chicago"
    volumes:
      - "/home/arthur/docker/pihole/etc-pihole/:/etc/pihole/"
      - "/home/arthur/docker/pihole/etc-dnsmasq.d/:/etc/dnsmasq.d/"
    cap_add:
      - NET_ADMIN
    restart: always
  mariadb:
    container_name: mariadb
    image: mariadb
    restart: always
    networks:
      dockerBridge:
        ipv4_address: 10.0.0.5
    ports:
      - "80:80"
      - "3306:3306"
    volumes:
      - "/home/arthur/docker/mariadb/data:/var/lib/mysql"
      - "/home/arthur/docker/mariadb/mysql:/etc/mysql"
  phpmyadmin:
    container_name: phpmyadmin
    image: phpmyadmin
    restart: always
    network_mode: "service:mariadb"
    depends_on:
      - mariadb
    environment:
      - PMA_HOST=10.0.0.5
      - UPLOAD_LIMIT=500M
  homeassistant:
    container_name: homeassistant
    hostname: homeassistant
    image: homeassistant/home-assistant
    restart: always
    ports:
      - 8123:8123
    networks:
      dockerBridge:
        ipv4_address: 10.0.0.3
    volumes:
      - "/etc/localtime:/etc/localtime:ro"
      - "/home/arthur/docker/homeassistant/:/config"
    depends_on:
      - mariadb
  analytics-for-spotify:
    container_name: analytics-for-spotify
    hostname: analytics-for-spotify
    #env_file: .env
    image: ${REPOSITORY}
    environment:
      - DOCKER=YES
      - CLIENT_ID=${CLIENT_ID}
      - CLIENT_SECRET=${CLIENT_SECRET}
      - REDIRECT_URL=${REDIRECT_URL}
      - HOST=${HOST}
      - DATABASE=${DATABASE}
      - USER=${USERNAME}
      - PASSWORD=${PASSWORD}
    restart: always
    networks:
      dockerBridge:
        ipv4_address: 10.0.0.6
    ports:
      - "80:80"
    depends_on:
      - mariadb
networks:
  dockerBridge:
    external: true
