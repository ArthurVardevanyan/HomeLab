apiVersion: v1
kind: Secret
metadata:
  name: s3-config
  namespace: gitea
  labels:
    name: s3
stringData:
  rclone.conf: |
    [unas]
    type = s3
    provider = Other
    env_auth = false
    access_key_id = <path:secret/data/homelab/minio#access_key>
    secret_access_key = <path:secret/data/homelab/minio#access_key>
    endpoint = https://s3.unas.arthurvardevanyan.com
    region = us-east-1
    acl = private

    [ceph]
    type = s3
    provider = Other
    env_auth = false
    access_key_id = <path:secret/data/homelab/gitea/minio#access_key>
    secret_access_key = <path:secret/data/homelab/gitea/minio#secret_key>
    endpoint = http://rook-ceph-rgw-rook-ceph-obj.rook-ceph.svc.cluster.local:8080
    region = us-east-1
    acl = private
  s3.sh: |-
    #!/bin/sh

    mkdir -p /tmp/.config/rclone
    cp /mnt/s3/rclone.conf /tmp/.config/rclone/rclone.conf
    rclone --progress sync ceph:gitea-64cf49f6-df6e-4146-aed8-eb0283f8ea64 unas:gitea --ignore-existing

type: Opaque
