kind: GitLab
apiVersion: apps.gitlab.com/v1beta1
metadata:
  name: gitlab
  namespace: gitlab-system
  labels:
    app.kubernetes.io/instance: gitlab-system
spec:
  chart:
    values:
      gitlab:
        gitaly:
          init:
            resources:
              requests:
                cpu: 50m
                memory: 50Mi
              limits:
                cpu: 50m
                memory: 50Mi
          resources:
            requests:
              cpu: 125m
              memory: 512Mi
            limits:
              cpu: 375m
              memory: 1536Mi
          persistence:
            enabled: true
            storageClass: longhorn-static
            accessMode: ReadWriteOnce
            size: 1Gi
        gitlab-exporter:
          init:
            resources:
              requests:
                cpu: 50m
                memory: 50Mi
              limits:
                cpu: 50m
                memory: 50Mi
          resources:
            requests:
              cpu: 50m
              memory: 64Mi
            limits:
              cpu: 100m
              memory: 128Mi
        gitlab-shell:
          init:
            resources:
              requests:
                cpu: 50m
                memory: 50Mi
              limits:
                cpu: 50m
                memory: 50Mi
          minReplicas: 1
        sidekiq:
          init:
            resources:
              requests:
                cpu: 50m
                memory: 50Mi
              limits:
                cpu: 50m
                memory: 100Mi
          resources:
            requests:
              cpu: 150m
              memory: 1.25Gi
            limits:
              cpu: 500m
              memory: 2.5Gi
        toolbox:
          init:
            resources:
              requests:
                cpu: 50m
                memory: 50Mi
              limits:
                cpu: 50m
                memory: 50Mi
          resources:
            requests:
              cpu: 25m
              memory: 16Mi
            limits:
              cpu: 500m
              memory: 32Mi
        migrations:
          init:
            resources:
              requests:
                cpu: 50m
                memory: 50Mi
              limits:
                cpu: 50m
                memory: 50Mi
          resources:
            requests:
              cpu: 250m
              memory: 256Mi
            limits:
              cpu: 750m
              memory: 2Gi
        webservice:
          init:
            resources:
              requests:
                cpu: 50m
                memory: 50Mi
              limits:
                cpu: 50m
                memory: 50Mi
          workerProcesses: 1
          minReplicas: 1
          resources:
            requests:
              cpu: 150m
              memory: 1.25Gi
            limits:
              cpu: 500m
              memory: 2.5Gi
          workhorse:
            resources:
              requests:
                cpu: 75m
                memory: 100M
              limits:
                cpu: 150m
                memory: 200M
      minio:
        init:
          resources:
            requests:
              cpu: 50m
              memory: 50Mi
            limits:
              cpu: 50m
              memory: 50Mi
        resources:
          requests:
            cpu: 150m
            memory: 150Mi
          limits:
            cpu: 300m
            memory: 300Mi
        persistence:
          enabled: true
          storageClass: longhorn-static
          accessMode: ReadWriteOnce
          size: 10Gi
      # nginx-ingress:
      #   controller:
      #     replicaCount: 1
      postgresql:
        init:
          resources:
            requests:
              cpu: 50m
              memory: 50Mi
            limits:
              cpu: 50m
              memory: 50Mi
        resources:
          requests:
            cpu: 100m
            memory: 256Mi
          limits:
            cpu: 200m
            memory: 512Mi
        persistence:
          enabled: true
          storageClass: longhorn-static
          accessMode: ReadWriteOnce
          size: 1Gi
      redis:
        init:
          resources:
            requests:
              cpu: 50m
              memory: 50Mi
            limits:
              cpu: 50m
              memory: 50Mi
        master:
          resources:
            requests:
              cpu: 50m
              memory: 48Mi
            limits:
              cpu: 100m
              memory: 96Mi
          persistence:
            enabled: true
            storageClass: longhorn-static
            accessMode: ReadWriteOnce
            size: 1Gi
      registry:
        init:
          resources:
            requests:
              cpu: 50m
              memory: 50Mi
            limits:
              cpu: 50m
              memory: 50Mi
        resources:
          requests:
            cpu: 100m
            memory: 100Mi
          limits:
            cpu: 300m
            memory: 300Mi
        hpa:
          minReplicas: 1
      certmanager:
        install: false
      global:
        edition: ce
        hosts:
          domain: <path:secret/data/gitlab/domain#url>
          hostSuffix: null
        ingress:
          class: "openshift-default"
          tls:
            secretName: gitlab-cert
        email:
          display_name: "GitLab"
          from: "noreply@<path:secret/data/gitlab/domain#url>"
          reply_to: "noreply@<path:secret/data/gitlab/domain#url>"
        smtp:
          enabled: true
          address: "x15.x10hosting.com"
          port: 465
          tls: true
          authentication: "login"
          user_name: "noreply@<path:secret/data/gitlab/domain#url>"
          password:
            secret: "smtp-password"
            key: "password"
      nginx-ingress:
        enabled: false
    version: 5.9.3
