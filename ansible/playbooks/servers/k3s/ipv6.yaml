---
- name: Configure IPv6 on K3s nodes
  hosts: k3s
  gather_facts: false
  become: true
  user: arthur
  ignore_unreachable: true
  tasks:
    - name: Modify sysctl.conf
      ansible.builtin.copy:
        src: "../../../../machineConfigs/servers/k3s-server/etc/sysctl.conf"
        dest: "/etc/sysctl.conf"
        mode: "0644"

    - name: Modify Grub
      ansible.builtin.copy:
        src: "../../../../machineConfigs/servers/k3s-server/etc/default/grub"
        dest: "/etc/default/grub"
        mode: "0644"
      notify: Update Grub

  handlers:
    - name: Update Grub
      ansible.builtin.command: update-grub
      changed_when: true
