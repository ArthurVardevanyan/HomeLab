---
- name: Install desktop packages
  hosts: ryzen
  gather_facts: false
  become: true
  user: arthur
  tasks:
    - name: Install RPM Fusion Free
      ansible.builtin.dnf:
        name: https://mirrors.rpmfusion.org/free/fedora/rpmfusion-free-release-43.noarch.rpm
        state: present
        disable_gpg_check: false
    - name: Upgrade all packages
      ansible.builtin.dnf:
        name: "*"
        state: latest  # noqa package-latest
    - name: Install core packages
      ansible.builtin.dnf:
        state: present
        name:
          # renovate: datasource=repology depName=fedora_43/openssh
          - openssh-server-9.6p1-11.fc43
          # renovate: datasource=repology depName=fedora_43/speedtest-cli
          - speedtest-cli-2.1.3-11.fc43
          # renovate: datasource=repology depName=fedora_43/gnome-screenshot
          - gnome-screenshot-41.0-7.fc43
          # renovate: datasource=repology depName=fedora_43/gnome-tweaks
          - gnome-tweaks-46.1-1.fc43
          # renovate: datasource=repology depName=fedora_43/thunderbird
          - thunderbird-115.12.0-1.fc43
          # renovate: datasource=repology depName=fedora_43/sshpass
          - sshpass-1.10-4.fc43
          # renovate: datasource=repology depName=fedora_43/htop
          - htop-3.3.0-2.fc43
          # renovate: datasource=repology depName=fedora_43/nvtop
          - nvtop-3.1.0-2.fc43
          # renovate: datasource=repology depName=fedora_43/pv
          - pv-1.8.5-2.fc43
          # renovate: datasource=repology depName=fedora_43/jq
          - jq-1.7.1-3.fc43
          # renovate: datasource=repology depName=fedora_43/rsync
          - rsync-3.3.0-1.fc43
          # renovate: datasource=repology depName=fedora_43/gparted
          - gparted-1.6.0-2.fc43
          # renovate: datasource=repology depName=fedora_43/smartmontools
          - smartmontools-7.4-4.fc43
          # - caffeine
    - name: Install development tools
      ansible.builtin.dnf:
        state: present
        name:
          # renovate: datasource=repology depName=fedora_43/gnupg
          - gnupg-2.4.5-1.fc43
          # renovate: datasource=repology depName=fedora_43/git
          - git-2.45.2-1.fc43
          # renovate: datasource=repology depName=fedora_43/gh
          - gh-2.51.0-1.fc43
          # renovate: datasource=repology depName=fedora_43/ansible
          - ansible-9.6.0-1.fc43
          # renovate: datasource=repology depName=fedora_43/make
          - make-4.4.1-6.fc43
          # renovate: datasource=repology depName=fedora_43/gcc
          - gcc-14.1.1-1.fc43
          # renovate: datasource=repology depName=fedora_43/gcc
          - gcc-c++-14.1.1-1.fc43
          # renovate: datasource=repology depName=fedora_43/python3-pip
          - python3-pip-24.0-4.fc43
          # renovate: datasource=repology depName=fedora_43/nodejs-typescript
          - nodejs-typescript-5.4.5-1.fc43
          # renovate: datasource=repology depName=fedora_43/cockpit
          - cockpit-317-1.fc43
          # renovate: datasource=repology depName=fedora_43/gdb
          - gdb-14.2-2.fc43
          # renovate: datasource=repology depName=fedora_43/android-tools
          - adb-34.0.4-4.fc43
          # renovate: datasource=repology depName=fedora_43/podman
          - podman-5.1.1-1.fc43
          # renovate: datasource=repology depName=fedora_43/buildah
          - buildah-1.36.0-1.fc43
          # renovate: datasource=repology depName=fedora_43/skopeo
          - skopeo-1.15.1-1.fc43
          # renovate: datasource=repology depName=fedora_43/npm
          - npm-10.8.1-1.20.11.1.1.fc43
          # renovate: datasource=repology depName=fedora_43/tree
          - tree-2.1.1-3.fc43
          # renovate: datasource=repology depName=fedora_43/kubernetes-helm
          - helm-3.14.4-1.fc43
          # renovate: datasource=repology depName=fedora_43/bat
          - bat-0.24.0-3.fc43
          # renovate: datasource=repology depName=fedora_43/opentofu
          - opentofu-1.7.2-1.fc43
          # - arduino
          # - apache2
          # - php
          # - mariadb-server
          # - libmariadb-dev
    - name: Install nvidia drivers
      ansible.builtin.dnf:
        state: present
        name:
          # renovate: datasource=repology depName=fedora_43/kernel
          - kernel-devel-6.8.11-300.fc43
          # renovate: datasource=repology depName=fedora_43/kernel-headers
          - kernel-headers-6.8.11-300.fc43
          # renovate: datasource=repology depName=fedora_43/dkms
          - dkms-3.0.12-1.fc43
          # renovate: datasource=repology depName=fedora_43/acpid
          - acpid-2.0.34-7.fc43
          # renovate: datasource=repology depName=fedora_43/libglvnd
          - libglvnd-glx-1.7.0-3.fc43
          # renovate: datasource=repology depName=fedora_43/libglvnd
          - libglvnd-opengl-1.7.0-3.fc43
          # renovate: datasource=repology depName=fedora_43/libglvnd
          - libglvnd-devel-1.7.0-3.fc43
          # renovate: datasource=repology depName=fedora_43/pkgconf
          - pkgconfig-1.9.5-3.fc43
          # renovate: datasource=repology depName=fedora_43/akmod-nvidia
          - akmod-nvidia-550.90.07-1.fc43
          # renovate: datasource=repology depName=fedora_43/xorg-x11-drv-nvidia-cuda
          - xorg-x11-drv-nvidia-cuda-550.90.07-1.fc43
    - name: Download YQ
      ansible.builtin.get_url:
        # renovate: datasource=github-releases depName=mikefarah/yq
        url: https://github.com/mikefarah/yq/releases/download/v4.44.2/yq_linux_amd64
        dest: /usr/local/bin/yq
        mode: "0755"
    - name: Download ArgoCD Vault Plugin
      ansible.builtin.get_url:
        # renovate: datasource=github-releases depName=argoproj-labs/argocd-vault-plugin
        url: https://github.com/argoproj-labs/argocd-vault-plugin/releases/download/v1.17.0/argocd-vault-plugin_1.17.0_linux_amd64
        dest: /usr/local/bin/argocd-vault-plugin
        mode: "0755"
    - name: Install additional packages
      ansible.builtin.dnf:
        state: present
        name:
          # renovate: datasource=repology depName=fedora_43/steam
          - steam-1.0.0.79-2.fc43
          # renovate: datasource=repology depName=fedora_43/vlc
          - vlc-3.0.21-1.fc43
          # renovate: datasource=repology depName=fedora_43/libavcodec-freeworld
          - libavcodec-freeworld-6.1.1-11.fc43
          # renovate: datasource=repology depName=fedora_43/gimp
          - gimp-2.10.38-1.fc43
          - winetricks
          - cura
          - obs-studio
          - openscad
          - handbrake
          - blender
    - name: Download YQ
      ansible.builtin.get_url:
        # renovate: datasource=github-releases depName=mikefarah/yq
        url: https://github.com/mikefarah/yq/releases/download/v4.44.2/yq_linux_amd64
        dest: /usr/local/bin/yq
        mode: "0755"
    - name: Download ArgoCD Vault Plugin
      ansible.builtin.get_url:
        # renovate: datasource=github-releases depName=argoproj-labs/argocd-vault-plugin
        url: https://github.com/argoproj-labs/argocd-vault-plugin/releases/download/v1.17.0/argocd-vault-plugin_1.17.0_linux_amd64
        dest: /usr/local/bin/argocd-vault-plugin
        mode: "0755"
    - name: Install additional packages
      ansible.builtin.dnf:
        state: present
        name:
          # renovate: datasource=repology depName=fedora_43/steam
          - steam-1.0.0.79-2.fc40
          # renovate: datasource=repology depName=fedora_43/vlc
          - vlc-3.0.21-1.fc40
          # renovate: datasource=repology depName=fedora_43/libavcodec-freeworld
          - libavcodec-freeworld-6.1.1-11.fc40
          # renovate: datasource=repology depName=fedora_43/gimp
          - gimp-2.10.38-1.fc40
          - winetricks
          - cura
          - obs-studio
          - openscad
          - handbrake
          - blender
          # - ffmpeg
          # - network-manager-openvpn
          # - network-manager-openvpn-gnome
    - name: Install virtual machine tools
      ansible.builtin.dnf:
        state: present
        name:
          - virt-manager
          - qemu
          - qemu-kvm
          # - libvirt-clients
          - libvirt-daemon
          # - libvirt-daemon-system
          # - virtinst
          - libguestfs-tools
          - bridge-utils
          - cockpit-machines
    - name: Install ProtonTricks
      ansible.builtin.pip:
        name:
          # renovate: datasource=pypi depName=protontricks
          - protontricks==1.11.1
        state: present
    - name: Install psutil
      ansible.builtin.pip:
        name:
          # renovate: datasource=pypi depName=psutil
          - psutil==6.0.0
        state: present
    - name: Remove UnNeeded Packages
      ansible.builtin.dnf:
        state: absent
        name:
          - geary
          - docker.io
          - docker-compose
    - name: Download Minio Client
      ansible.builtin.get_url:
        url: https://dl.min.io/client/mc/release/linux-amd64/mc
        dest: /usr/local/bin/mc
        mode: "0755"
    - name: Download golang
      ansible.builtin.get_url:
        # renovate: datasource=golang-version depName=golang
        url: https://go.dev/dl/go1.22.4.linux-amd64.tar.gz
        dest: /tmp/go.linux-amd64.tar.gz
        mode: "0644"
      check_mode: false
    - name: Extract golang
      ansible.builtin.unarchive:
        src: /tmp/go.linux-amd64.tar.gz
        dest: /usr/local
        remote_src: true
    - name: Install Webex
      ansible.builtin.dnf:
        name: https://binaries.webex.com/WebexDesktop-CentOS-Official-Package/Webex.rpm
        state: present
    - name: Install JC
      ansible.builtin.pip:
        name:
          # renovate: datasource=pypi depName=jc
          - jc==1.25.2
        state: present
    - name: Install pre-commit
      ansible.builtin.pip:
        name:
          # renovate: datasource=pypi depName=pre-commit
          - pre-commit==3.7.1
        state: present
