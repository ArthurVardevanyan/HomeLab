# Generated by Butane; do not edit
apiVersion: machineconfiguration.openshift.io/v1
kind: MachineConfig
metadata:
  labels:
    machineconfiguration.openshift.io/role: master
  name: raid1-storage
spec:
  config:
    ignition:
      version: 3.4.0
    storage:
      disks:
        - device: /dev/disk/by-path/pci-0000:02:00.1-ata-4.0
          partitions:
            - label: bios-1
              sizeMiB: 1
              typeGuid: 21686148-6449-6E6F-744E-656564454649
            - label: esp-1
              sizeMiB: 127
              typeGuid: C12A7328-F81F-11D2-BA4B-00A0C93EC93B
            - label: boot-1
              sizeMiB: 384
            - label: root-1
              sizeMiB: 100000
            - label: var-1
          wipeTable: true
        - device: /dev/disk/by-path/pci-0000:02:00.1-ata-3.0
          partitions:
            - label: bios-2
              sizeMiB: 1
              typeGuid: 21686148-6449-6E6F-744E-656564454649
            - label: esp-2
              sizeMiB: 127
              typeGuid: C12A7328-F81F-11D2-BA4B-00A0C93EC93B
            - label: boot-2
              sizeMiB: 384
            - label: root-2
              sizeMiB: 100000
            - label: var-2
          wipeTable: true
      filesystems:
        - device: /dev/disk/by-partlabel/esp-1
          format: vfat
          label: esp-1
          wipeFilesystem: true
        - device: /dev/disk/by-partlabel/esp-2
          format: vfat
          label: esp-2
          wipeFilesystem: true
        - device: /dev/md/md-boot
          format: ext4
          label: boot
          wipeFilesystem: true
        - device: /dev/md/md-root
          format: xfs
          label: root
          wipeFilesystem: true
        - device: /dev/md/md-var
          format: xfs
          path: /var
          wipeFilesystem: true
      raid:
        - devices:
            - /dev/disk/by-partlabel/boot-1
            - /dev/disk/by-partlabel/boot-2
          level: raid1
          name: md-boot
          options:
            - --metadata=1.0
        - devices:
            - /dev/disk/by-partlabel/root-1
            - /dev/disk/by-partlabel/root-2
          level: raid1
          name: md-root
        - devices:
            - /dev/disk/by-partlabel/var-1
            - /dev/disk/by-partlabel/var-2
          level: raid1
          name: md-var
    systemd:
      units:
        - contents: |-
            # Generated by Butane
            [Unit]
            Requires=systemd-fsck@dev-md-md\x2dvar.service
            After=systemd-fsck@dev-md-md\x2dvar.service

            [Mount]
            Where=/var
            What=/dev/md/md-var
            Type=xfs

            [Install]
            RequiredBy=local-fs.target
          enabled: true
          name: var.mount
